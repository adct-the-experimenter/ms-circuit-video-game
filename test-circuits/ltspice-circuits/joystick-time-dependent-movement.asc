Version 4
SHEET 1 5280 1564
WIRE 4528 -16 4368 -16
WIRE 768 0 688 0
WIRE 832 0 768 0
WIRE 832 16 832 0
WIRE 880 16 832 16
WIRE 976 32 944 32
WIRE 1040 32 976 32
WIRE 880 48 848 48
WIRE 768 80 768 64
WIRE 832 80 768 80
WIRE 848 80 848 48
WIRE 848 80 832 80
WIRE 352 96 304 96
WIRE 528 96 432 96
WIRE 1632 96 1552 96
WIRE 1776 96 1696 96
WIRE 4368 96 4368 -16
WIRE 4416 96 4368 96
WIRE 4528 112 4528 -16
WIRE 4528 112 4480 112
WIRE 4576 112 4528 112
WIRE 128 128 32 128
WIRE 688 128 688 0
WIRE 768 128 768 80
WIRE 4096 128 3840 128
WIRE 4240 128 4176 128
WIRE 4416 128 4240 128
WIRE 32 160 32 128
WIRE 4448 176 4448 144
WIRE 1552 192 1552 96
WIRE 1632 192 1552 192
WIRE 1776 192 1776 96
WIRE 1776 192 1712 192
WIRE 2880 192 2880 144
WIRE 2928 192 2880 192
WIRE 3104 192 3008 192
WIRE 4096 192 4096 128
WIRE 4240 208 4240 128
WIRE 2432 240 2432 176
WIRE 2480 240 2432 240
WIRE 2704 240 2560 240
WIRE 128 256 128 128
WIRE 176 256 128 256
WIRE 304 256 304 96
WIRE 304 256 256 256
WIRE 384 256 304 256
WIRE 528 272 528 96
WIRE 528 272 448 272
WIRE 592 272 592 208
WIRE 592 272 528 272
WIRE 768 272 768 208
WIRE 768 272 592 272
WIRE 3904 272 3904 240
WIRE 4048 272 3904 272
WIRE 384 288 368 288
WIRE 4176 288 4176 128
WIRE 4176 288 4096 288
WIRE 4240 288 4240 272
WIRE 976 336 976 32
WIRE 1408 336 976 336
WIRE 1552 336 1552 192
WIRE 1552 336 1488 336
WIRE 1632 336 1552 336
WIRE 1648 336 1632 336
WIRE 1776 352 1776 192
WIRE 1776 352 1696 352
WIRE 2000 352 2000 256
WIRE 2000 352 1776 352
WIRE 2480 352 2000 352
WIRE 2704 352 2704 240
WIRE 2704 352 2560 352
WIRE 2752 352 2704 352
WIRE 2880 352 2880 192
WIRE 2960 352 2880 352
WIRE 1632 368 1568 368
WIRE 3104 368 3104 192
WIRE 3104 368 3024 368
WIRE 3168 368 3104 368
WIRE 176 384 112 384
WIRE 320 384 256 384
WIRE 368 384 368 288
WIRE 368 384 320 384
WIRE 2752 384 2752 352
WIRE 2960 384 2752 384
WIRE 1568 400 1568 368
WIRE 320 416 320 384
WIRE -464 432 -464 400
WIRE -288 432 -464 432
WIRE -288 496 -288 432
WIRE -608 576 -608 560
WIRE 1168 816 1136 816
WIRE 1312 816 1248 816
WIRE 800 880 384 880
WIRE 976 880 880 880
WIRE 976 928 976 880
WIRE 1136 928 1136 816
WIRE 1136 928 976 928
WIRE 1200 928 1136 928
WIRE 1312 944 1312 816
WIRE 1312 944 1264 944
WIRE 1360 944 1312 944
WIRE 1200 960 1152 960
WIRE 592 992 528 992
WIRE 704 992 672 992
WIRE 800 992 704 992
WIRE 976 992 976 928
WIRE 976 992 880 992
WIRE 1152 992 1152 960
WIRE 704 1040 704 992
WIRE 528 1136 528 992
WIRE 608 1136 528 1136
WIRE 704 1136 704 1104
WIRE 704 1136 672 1136
WIRE 384 1248 384 880
WIRE 384 1248 256 1248
WIRE 416 1248 384 1248
WIRE 528 1248 528 1136
WIRE 528 1248 496 1248
WIRE 592 1248 528 1248
WIRE 704 1264 704 1136
WIRE 704 1264 656 1264
WIRE 592 1280 544 1280
WIRE 544 1328 544 1280
FLAG -608 576 0
FLAG -464 400 joystick_x
FLAG -688 272 0
FLAG -880 192 VCC
FLAG -880 272 0
FLAG -688 192 VEE
FLAG 416 240 VCC
FLAG 416 304 VEE
FLAG 320 496 0
FLAG 112 464 0
FLAG 32 160 joystick_x
FLAG 592 208 velocity_inv
FLAG -288 576 0
FLAG 688 208 0
FLAG 912 0 VCC
FLAG 1040 32 dir_detect_vel
FLAG 912 64 VEE
FLAG 4448 80 VCC
FLAG 3904 240 abs_dir_detect
FLAG 4576 112 xpos_stored
FLAG 4240 288 0
FLAG 624 1232 VCC
FLAG 624 1296 VEE
FLAG 544 1328 0
FLAG 1232 912 VCC
FLAG 1232 976 VEE
FLAG 1152 992 0
FLAG 1360 944 abs_dir_detect
FLAG 256 1248 dir_detect_vel
FLAG 4448 176 0
FLAG 2000 256 xpos_change
FLAG 2992 336 VCC
FLAG 2992 400 VEE
FLAG 2880 64 0
FLAG 2432 176 xpos_stored
FLAG 3840 128 new_x
FLAG 3168 368 new_x
FLAG 1664 320 VCC
FLAG 1664 384 VEE
FLAG 1568 400 0
DATAFLAG 4096 176 ""
DATAFLAG 4016 272 ""
SYMBOL voltage -608 464 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value SINE(2.5 2.5 10 0.2)
SYMBOL voltage -688 176 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value -5
SYMBOL voltage -880 176 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V3
SYMATTR Value 5
SYMBOL Opamps\\UniversalOpamp2 416 272 R0
SYMATTR InstName U1
SYMBOL res 448 80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL res 304 400 R0
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL res 272 240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL res 272 368 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL voltage 112 368 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 2.5
SYMBOL voltage -288 480 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC 1
SYMATTR InstName V6
SYMATTR Value PULSE(0 5 0.2 0.5 0.5 0.3 0 5)
SYMBOL Opamps\\UniversalOpamp2 912 32 R0
SYMATTR InstName U7
SYMBOL res 752 112 R0
SYMATTR InstName R12
SYMATTR Value 10k
SYMBOL res 672 112 R0
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL diode 752 0 R0
SYMATTR InstName D2
SYMATTR Value 1N914
SYMBOL diode 848 80 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMATTR Value 1N914
SYMBOL Opamps\\UniversalOpamp2 4448 112 R0
SYMATTR InstName U3
SYMBOL cap 4224 208 R0
SYMATTR InstName C2
SYMATTR Value 100n
SYMBOL nmos 4048 192 R0
SYMATTR InstName M1
SYMATTR Value RSJ800N06
SYMBOL Opamps\\UniversalOpamp2 624 1264 R0
SYMATTR InstName U4
SYMBOL res 512 1232 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL diode 672 1120 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D1
SYMATTR Value 1N914
SYMBOL diode 688 1040 R0
SYMATTR InstName D4
SYMATTR Value 1N914
SYMBOL res 688 976 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL res 896 976 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 5k
SYMBOL res 896 864 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL Opamps\\UniversalOpamp2 1232 944 R0
SYMATTR InstName U5
SYMBOL res 1264 800 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL res 2576 336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 10k
SYMBOL Opamps\\UniversalOpamp2 2992 368 R0
SYMATTR InstName U2
SYMBOL res 2576 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 10k
SYMBOL res 3024 176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 10k
SYMBOL res 2864 48 R0
SYMATTR InstName R21
SYMATTR Value 5k
SYMBOL Opamps\\UniversalOpamp2 1664 352 R0
SYMATTR InstName U10
SYMBOL res 1504 320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL res 1728 176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 5k
SYMBOL cap 1696 112 M270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C1
SYMATTR Value 1µ
TEXT -624 56 Left 2 ;joystick controls direction i.e. negative, positive, or zero.
TEXT -576 224 Left 2 !.tran 0 2 0 0.1
TEXT 2400 -192 Left 2 ;Position is limited to a range of 0V to 5V. Therefore clipping negative portion of signal representing new x position.
TEXT -416 160 Left 2 !;ac dec 10 1 10G
TEXT 4048 48 Left 2 ;Sample/hold control
TEXT 880 -128 Left 2 ;convert direction detection waveform to change in position with low-pass filter.
TEXT 3760 392 Left 2 ;Only sample new if joystick is moved from center position.
